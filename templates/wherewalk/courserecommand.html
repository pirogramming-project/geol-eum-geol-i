<!DOCTYPE html>
{% load static %}
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>걸음걸이_어디걸음</title>
    <link rel="stylesheet" href="{% static 'css/reset.css' %}" />
    <link rel="stylesheet" href="{% static 'css/root.css' %}" />
    <link rel="stylesheet" href="{% static 'css/main/landing.css' %}" />
    <link rel="stylesheet" href="{% static 'css/wherewalk/courserecommand.css' %}" />
    <link rel="stylesheet" href="{% static 'css/main/navBar.css' %}" />
    <link rel="icon" type="image/png" href="{% static 'image/favicon/favicon-96x96.png' %}" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="{% static 'image/favicon/favicon.svg' %}" />
    <link rel="shortcut icon" href="{% static 'image/favicon/favicon.ico' %}" />
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'image/favicon/apple-touch-icon.png' %}" />
    <meta name="apple-mobile-web-app-title" content="걸음걸이" />
    <link rel="manifest" href="{% static 'image/favicon/site.webmanifest' %}" />
    <style></style>
  </head>
  <body>
    <div class="landing__layout">
      <a href="{% url 'record:ranking'%}" class="link-ranking">
        <div class="to-ranking">
          <svg xmlns="http://www.w3.org/2000/svg" width="48" height="59" viewBox="0 0 48 59" fill="none">
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M16.4078 42.109H4.38664V27.6734C4.38664 27.1626 4.79988 26.7448 5.31063 26.7448H15.4745C15.9853 26.7448 16.4031 27.1626 16.4031 27.6734V42.109H16.4078ZM18.813 20.4393C18.3022 20.4393 17.889 20.8572 17.889 21.368V42.109H29.9101V21.368C29.9101 20.8572 29.4969 20.4393 28.9815 20.4393H18.813ZM31.3913 33.9742V42.109H43.4124V33.9742C43.4124 33.4634 42.9992 33.0455 42.4884 33.0455H32.3199C31.8092 33.0502 31.3913 33.4634 31.3913 33.9742ZM45.7619 43.5901H2.03256C1.84219 43.5901 1.68896 43.7434 1.68896 43.9291V45.8514C1.68896 46.0417 1.84219 46.1903 2.03256 46.1903H45.7619C45.9522 46.1903 46.1008 46.0371 46.1008 45.8514V43.9291C46.1055 43.7434 45.9522 43.5901 45.7619 43.5901ZM16.0549 12.7874H31.7442L33.1232 7.71243C32.3338 7.45241 31.6652 6.92774 31.2148 6.24055L27.5096 8.58999C27.3982 8.65964 27.2774 8.67821 27.1474 8.64106C27.0221 8.60392 26.9246 8.52499 26.8688 8.40891L25.513 5.6648C25.0255 5.90624 24.4776 6.04089 23.9019 6.04089C23.3215 6.04089 22.7736 5.90624 22.2907 5.6648L20.9349 8.40891C20.8745 8.52499 20.7817 8.60392 20.6563 8.64106C20.5309 8.67821 20.4056 8.65964 20.2941 8.58999L17.016 6.50985C16.4542 7.20633 15.637 7.68922 14.713 7.82387L16.0549 12.7874ZM30.7412 16.488L31.3402 14.2686H16.4542L17.0578 16.488C17.1136 16.6877 17.2853 16.8177 17.4896 16.8177H30.3048C30.5137 16.8223 30.6855 16.6877 30.7412 16.488ZM23.8972 4.56437C25.0905 4.56437 26.0609 3.5893 26.0609 2.40065C26.0609 1.20736 25.0905 0.236938 23.8972 0.236938C22.7039 0.236938 21.7335 1.20736 21.7335 2.40065C21.7335 3.5893 22.7039 4.56437 23.8972 4.56437ZM34.27 6.41699C35.4633 6.41699 36.4338 5.44657 36.4338 4.25327C36.4338 3.05998 35.4587 2.08956 34.27 2.08956C33.0767 2.08956 32.1063 3.05998 32.1063 4.25327C32.1063 5.44657 33.0767 6.41699 34.27 6.41699ZM14.1791 6.37984C15.3724 6.37984 16.3428 5.40942 16.3428 4.21613C16.3428 3.02284 15.3724 2.05242 14.1791 2.05242C12.9858 2.05242 12.0154 3.02284 12.0154 4.21613C12.0107 5.40942 12.9858 6.37984 14.1791 6.37984Z"
              fill="#B82132"
            />
          </svg>
          <div class="ranking-word">이달의 걸음왕</div>
        </div>
      </a>
      <div class="wrapper">
        <div class="container">
          <div class="courserecommand-page-header">
            <div class="courserecommand-title">
              <a href="{% url 'users:success' %}" class="home-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="47" height="57" viewBox="0 -13 47 57" fill="none">
                  <path
                    d="M36.4381 26.8837V40.0532C36.4381 41.8312 34.8251 43.2793 32.8327 43.2793H26.9761V31.3566C26.9761 30.2037 26.0426 29.2702 24.8897 29.2702H21.5498C20.3937 29.2702 19.4635 30.2037 19.4635 31.3566V43.2793H13.6068C11.6227 43.2793 10.0014 41.8312 10.0014 40.0532V26.8837C10.1795 26.7947 23.2174 15.2642 23.2174 15.2642C23.2174 15.2642 36.2552 26.7913 36.4334 26.8837H36.4381ZM40.474 21.4953L24.5612 7.88709C23.7976 7.22408 22.6481 7.22408 21.8927 7.88709L5.96518 21.4953C5.17187 22.1798 5.04816 23.3524 5.6782 24.1672C6.01136 24.6141 6.53582 24.9061 7.10156 24.9605C7.16423 24.9687 7.2368 24.9737 7.29947 24.9737C7.78933 24.9737 8.26598 24.8005 8.63378 24.4838L23.222 12.0067L37.8136 24.4872C38.1847 24.7989 38.6531 24.9721 39.1429 24.9721C39.7894 24.9721 40.393 24.6769 40.7691 24.1738C41.3975 23.3541 41.2721 22.1814 40.4772 21.497L40.474 21.4953Z"
                    fill="#B82132"
                  />
                </svg>
              </a>
              <div class="courserecommand-title-firstword">어디</div>
              <div class="courserecommand-title-secondword">걸음?</div>
            </div>
            <div class="course-recommand-introduction">나만의 검색으로 장소를 추천받아요</div>
          </div>
          <form method="GET" action="{% url 'course:course_list' %}">
            <div class="search-box">
              <input type="text" name="search" placeholder="검색어를 입력하세요" value="{{ search_term }}" />
              <button type="submit" style="background: none; border: none" class="search_button">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="28" viewBox="0 0 22 28" fill="none">
                  <path
                    d="M14.346 12.4615C14.3483 12.4583 14.3507 12.4552 14.3529 12.4519C15.3745 10.9567 15.8013 9.13394 15.5495 7.34058C15.2977 5.54721 14.3855 3.91242 12.9916 2.75632C11.5977 1.60022 9.82246 1.00609 8.01346 1.09026C6.20447 1.17443 4.49204 1.93084 3.2115 3.21138C1.93096 4.49192 1.17455 6.20434 1.09038 8.01334C1.00621 9.82233 1.60035 11.5976 2.75645 12.9915C3.91254 14.3854 5.54734 15.2976 7.3407 15.5494C9.13406 15.8011 10.9568 15.3744 12.4521 14.3527C12.4553 14.3505 12.4584 14.3481 12.4616 14.3459L18.6253 20.5097C18.8752 20.7596 19.2142 20.9 19.5676 20.9C19.921 20.9 20.2599 20.7596 20.5098 20.5097C20.7597 20.2598 20.9001 19.9209 20.9001 19.5675C20.9001 19.2141 20.7597 18.8751 20.5098 18.6252L14.346 12.4615ZM8.36008 14.3572C6.91314 14.3582 5.51454 13.8365 4.4218 12.888C3.32906 11.9396 2.61577 10.6283 2.41325 9.19559C2.21073 7.7629 2.53263 6.30528 3.31967 5.09112C4.10671 3.87696 5.30591 2.98801 6.69644 2.58797C8.08698 2.18793 9.57523 2.30372 10.8872 2.91403C12.1991 3.52433 13.2463 4.58806 13.8361 5.90935C14.4259 7.23063 14.5185 8.7205 14.0968 10.1046C13.6751 11.4888 12.7676 12.6739 11.5413 13.442C10.5876 14.0391 9.48528 14.3562 8.36008 14.3572Z"
                    fill="#76453B"
                  />
                </svg>
              </button>
            </div>
          </form>

          <div class="keywords-container">
            <div class="keywords">
              <!-- 키워드1은 기본으로 항상 보이고, 처음에는 선택되지 않음 -->
              {% for keyword in keywords|slice:":3" %}
              <button class="keyword passive">{{ keyword.name }}</button>
              {% endfor %}

              <!-- 드롭다운 버튼 -->
              <button class="keyword passive" id="loadMoreKeywords">
                <svg xmlns="http://www.w3.org/2000/svg" width="38" height="31" viewBox="5 0 38 31" fill="none">
                  <path
                    d="M23.7281 20.1412L33.6978 11.8304C34.1109 11.4866 34.1668 10.8716 33.8218 10.4588C33.4762 10.045 32.8636 9.9891 32.4502 10.3335L23.104 18.1247L13.7584 10.3335C13.3441 9.98971 12.7312 10.0456 12.3862 10.4588C12.0411 10.8713 12.097 11.4866 12.5102 11.8304L22.4793 20.1412C22.6604 20.2926 22.8824 20.368 23.104 20.368C23.3259 20.368 23.5475 20.2926 23.7281 20.1412Z"
                    fill="#76453B"
                  />
                </svg>
              </button>
            </div>
          </div>
          <div class="search-container">
            <button class="find-btn" id="findButton">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="30" viewBox="0 -4 24 30" fill="none">
                <path
                  d="M5.83206 12.9121C5.42406 12.9121 5.11206 13.2241 5.11206 13.6321C5.11206 14.0401 5.42406 14.3521 5.83206 14.3521C6.50406 14.3521 7.05606 14.9041 7.05606 15.5761C7.05606 15.9841 7.36806 16.2961 7.77606 16.2961C8.18406 16.2961 8.49606 15.9841 8.49606 15.5761C8.47206 14.0881 7.29606 12.9121 5.83206 12.9121Z"
                  fill="white"
                />
                <path
                  d="M23.328 14.6639C23.016 12.8879 21.48 8.68787 20.352 5.78387C19.728 4.17587 18.144 3.09587 16.44 3.21587C14.448 3.35987 12.936 4.99187 12.864 6.93587C12.864 7.17587 12.84 7.43987 12.84 7.70387C12.84 7.87187 12.696 8.01587 12.528 8.01587H11.448C11.28 8.01587 11.136 7.87187 11.136 7.70387C11.136 7.48787 11.136 7.27187 11.112 7.07987C11.064 5.35187 9.93595 3.79187 8.27995 3.35987C6.35995 2.83187 4.36795 3.86387 3.67195 5.68787C2.54395 8.59187 0.959954 12.8879 0.647954 14.6879C0.191954 17.5199 2.08795 20.2079 4.94395 20.7119C7.77595 21.1919 10.488 19.2959 10.968 16.4639C11.016 16.1279 11.064 15.6719 11.112 15.1679C11.136 14.6879 11.544 14.3279 12 14.3279C12.48 14.3279 12.864 14.6879 12.888 15.1679C12.912 15.6719 12.96 16.1279 13.032 16.4639C13.512 19.3199 16.224 21.2159 19.056 20.7119C21.912 20.2079 23.808 17.5199 23.328 14.6639ZM5.83195 19.1999C3.81595 19.1999 2.18395 17.5679 2.18395 15.5519C2.18395 13.5359 3.81595 11.9039 5.83195 11.9039C7.84795 11.9039 9.47995 13.5359 9.47995 15.5519C9.45595 17.5679 7.82395 19.1999 5.83195 19.1999ZM18.168 19.1999C16.152 19.1999 14.52 17.5679 14.52 15.5519C14.52 13.5359 16.152 11.9039 18.168 11.9039C20.184 11.9039 21.816 13.5359 21.816 15.5519C21.816 17.5679 20.184 19.1999 18.168 19.1999Z"
                  fill="white"
                />
                <path
                  d="M18.168 12.9121C17.76 12.9121 17.448 13.2241 17.448 13.6321C17.448 14.0401 17.76 14.3521 18.168 14.3521C18.84 14.3521 19.392 14.9041 19.392 15.5761C19.392 15.9841 19.704 16.2961 20.112 16.2961C20.52 16.2961 20.832 15.9841 20.832 15.5761C20.832 14.0881 19.656 12.9121 18.168 12.9121Z"
                  fill="white"
                />
              </svg>
              키워드로 찾기
            </button>
            <form method="GET" action="{% url 'course:course_list' %}" class="map-select-element">
              <button type="button" id="select-location" class="register-btn" onclick="openMapPopup()">
                <svg xmlns="http://www.w3.org/2000/svg" width="23" height="29" viewBox="0 -2 23 29" fill="none">
                  <path
                    d="M4.54022 13.2319L4.58162 13.2917C4.63222 13.3676 4.68512 13.4412 4.73802 13.5217L10.7318 22.1329C10.8181 22.2567 10.9329 22.3579 11.0667 22.4277C11.2005 22.4976 11.3491 22.5341 11.5 22.5341C11.6509 22.5341 11.7996 22.4976 11.9333 22.4277C12.0671 22.3579 12.182 22.2567 12.2682 22.1329L18.2482 13.5286C18.3057 13.4481 18.3609 13.3699 18.4161 13.2986L18.4529 13.2434C19.261 11.9931 19.717 10.5481 19.773 9.06048C19.829 7.57286 19.4829 6.09765 18.7711 4.79016C18.0594 3.48266 17.0083 2.39124 15.7285 1.63079C14.4487 0.870343 12.9875 0.468994 11.4989 0.468994C10.0102 0.468994 8.54906 0.870343 7.26926 1.63079C5.98947 2.39124 4.93836 3.48266 4.2266 4.79016C3.51483 6.09765 3.16873 7.57286 3.22473 9.06048C3.28074 10.5481 3.73677 11.9931 4.54482 13.2434L4.54022 13.2319ZM11.5 5.30379C12.1824 5.30379 12.8494 5.50613 13.4167 5.88522C13.9841 6.26431 14.4263 6.80313 14.6874 7.43353C14.9485 8.06394 15.0169 8.75762 14.8837 9.42685C14.7506 10.0961 14.422 10.7108 13.9395 11.1933C13.4571 11.6758 12.8423 12.0044 12.1731 12.1375C11.5038 12.2706 10.8102 12.2023 10.1798 11.9412C9.54936 11.6801 9.01054 11.2379 8.63145 10.6705C8.25236 10.1032 8.05002 9.43614 8.05002 8.75379C8.05002 7.83879 8.4135 6.96127 9.0605 6.31427C9.70751 5.66727 10.585 5.30379 11.5 5.30379Z"
                    fill="#419049"
                  />
                </svg>
                지도보며 선택
              </button>
              <input type="hidden" name="latitude" id="latitude" value="{{ latitude }}" />
              <input type="hidden" name="longitude" id="longitude" value="{{ longitude }}" />
              <div class="map-popup" id="map-popup">
                <div class="map-popup-content">
                  <input id="search-location" type="text" placeholder="장소 검색" class="map-search-box" />
                  <div id="map"></div>
                  <div class="map_Btn">
                    <button type="submit" class="close-btn" onclick="closeMapPopup()">확인</button>
                  </div>
                </div>
              </div>
            </form>
          </div>

          <div class="recommendations">
            {% for course in page_obj %}
            <div class="card" data-id="{{ course.id }}">
              <img
                src="{% if course.image %}{{ course.image.url }}{% else %}{% static 'defaultimage/geoleumi.png' %}{% endif %}"
                alt="{{ course.title }}"
                class="course-image"
                style="width: 77px; height: 74px"
              />

              <p>{{ course.title|slice:":6" }}{% if course.title|length > 6 %}...{% endif %}</p>
            </div>
            {% endfor %}
          </div>

          <div class="pagination">
            <!-- 이전 페이지 버튼 -->
            <a
              href="{% if page_obj.has_previous %}?page={{ page_obj.previous_page_number }}{% else %}#{% endif %}"
              onclick="{% if not page_obj.has_previous %}alert('첫 번째 페이지입니다.'); return false;{% endif %}"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path
                  d="M10 0C4.48584 0 0 4.48584 0 10C0 15.5142 4.48584 20 10 20C15.5142 20 20 15.5142 20 10C20 4.48584 15.5142 0 10 0ZM15 11H7.41406L8.70703 12.293C9.09766 12.6836 9.09766 13.3164 8.70703 13.707C8.51172 13.9023 8.25586 14 8 14C7.74414 14 7.48828 13.9023 7.29297 13.707L4.29297 10.707C3.90234 10.3164 3.90234 9.68359 4.29297 9.29297L7.29297 6.29297C7.68359 5.90234 8.31641 5.90234 8.70703 6.29297C9.09766 6.68359 9.09766 7.31641 8.70703 7.70703L7.41406 9H15C15.5522 9 16 9.44775 16 10C16 10.5522 15.5522 11 15 11Z"
                  fill="#76453B"
                />
              </svg>
            </a>

            <span class="pagination-status">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>

            <!-- 다음 페이지 버튼 -->
            <a
              href="{% if page_obj.has_next %}?page={{ page_obj.next_page_number }}{% else %}#{% endif %}"
              onclick="{% if not page_obj.has_next %}alert('마지막 페이지입니다.'); return false;{% endif %}"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path
                  d="M10 0C15.5142 0 20 4.48584 20 10C20 15.5142 15.5142 20 10 20C4.48584 20 0 15.5142 0 10C0 4.48584 4.48584 0 10 0ZM5 11H12.5859L11.293 12.293C10.9023 12.6836 10.9023 13.3164 11.293 13.707C11.4883 13.9023 11.7441 14 12 14C12.2559 14 12.5117 13.9023 12.707 13.707L15.707 10.707C16.0977 10.3164 16.0977 9.68359 15.707 9.29297L12.707 6.29297C12.3164 5.90234 11.6836 5.90234 11.293 6.29297C10.9023 6.68359 10.9023 7.31641 11.293 7.70703L12.5859 9H5C4.44775 9 4 9.44775 4 10C4 10.5522 4.44775 11 5 11Z"
                  fill="#76453B"
                />
              </svg>
            </a>
          </div>
        </div>

        <form method="GET" action="{% url 'course:course_form' %}">
          <button class="recommend-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="33" height="40" viewBox="0 0 33 40" fill="none">
              <path
                d="M28.07 17.885C28.55 17.355 29.095 16.755 29.095 16C29.095 15.245 28.55 14.645 28.07 14.115C27.76 13.77 27.44 13.415 27.36 13.115C27.27 12.795 27.375 12.31 27.475 11.845C27.625 11.125 27.785 10.38 27.42 9.75001C27.05 9.11501 26.29 8.87001 25.615 8.65001C25.165 8.50501 24.705 8.35501 24.475 8.12501C24.245 7.89501 24.095 7.43501 23.95 6.98501C23.73 6.31001 23.485 5.55001 22.85 5.18001C22.22 4.81501 21.475 4.97501 20.755 5.12501C20.29 5.22501 19.81 5.33001 19.485 5.24001C19.185 5.16001 18.83 4.84001 18.485 4.53001C17.955 4.05001 17.355 3.51001 16.6 3.51001C15.845 3.51001 15.245 4.05001 14.715 4.53001C14.37 4.84001 14.015 5.16001 13.715 5.24001C13.395 5.33001 12.91 5.22501 12.445 5.12501C11.725 4.97501 10.98 4.81501 10.35 5.18001C9.71498 5.55001 9.46998 6.31001 9.24998 6.98501C9.10498 7.43501 8.95498 7.89501 8.72498 8.12501C8.49498 8.35501 8.03498 8.50501 7.58498 8.65001C6.90998 8.87001 6.14998 9.11501 5.77998 9.75001C5.41498 10.38 5.57498 11.125 5.72498 11.845C5.82498 12.31 5.92998 12.795 5.83998 13.115C5.75998 13.415 5.43998 13.77 5.12998 14.115C4.64998 14.645 4.10498 15.245 4.10498 16C4.10498 16.755 4.64998 17.355 5.12998 17.885C5.43998 18.23 5.75998 18.585 5.83998 18.885C5.92998 19.205 5.82498 19.69 5.72498 20.155C5.57498 20.875 5.41498 21.62 5.77998 22.25C6.14998 22.885 6.90998 23.13 7.58498 23.35C8.03498 23.495 8.49498 23.645 8.72498 23.875C8.95498 24.105 9.10498 24.565 9.24998 25.015C9.46998 25.69 9.71498 26.45 10.35 26.82C10.98 27.185 11.725 27.025 12.445 26.875C12.91 26.775 13.39 26.67 13.715 26.76C14.015 26.84 14.37 27.16 14.715 27.47C15.245 27.95 15.845 28.49 16.6 28.49C17.355 28.49 17.955 27.95 18.485 27.47C18.83 27.16 19.185 26.84 19.485 26.76C19.805 26.675 20.29 26.775 20.755 26.875C21.475 27.025 22.22 27.185 22.85 26.82C23.485 26.45 23.73 25.69 23.95 25.015C24.095 24.565 24.245 24.105 24.475 23.875C24.705 23.645 25.165 23.495 25.615 23.35C26.29 23.13 27.05 22.885 27.42 22.25C27.785 21.62 27.625 20.875 27.475 20.155C27.375 19.69 27.27 19.205 27.36 18.885C27.44 18.585 27.76 18.23 28.07 17.885ZM16.6 23.5C12.465 23.5 9.09998 20.135 9.09998 16C9.09998 11.865 12.465 8.50001 16.6 8.50001C20.735 8.50001 24.1 11.865 24.1 16C24.1 20.135 20.735 23.5 16.6 23.5Z"
                fill="white"
              />
              <path
                d="M20.8551 14.0051C20.3551 13.8001 19.6951 13.7601 19.2251 13.7651L19.3451 11.5101C19.3701 11.0101 19.1001 10.5351 18.6701 10.3351C18.3451 10.1751 18.0401 10.1551 17.7501 10.2651C17.0701 10.5301 16.7151 11.4351 16.0601 13.0851C15.6051 14.2401 15.0051 14.6551 14.5951 14.8051C14.3301 14.3801 13.8601 14.0951 13.3251 14.0951H12.6201C11.7901 14.0951 11.1201 14.7651 11.1201 15.5951V19.3051C11.1201 20.1301 11.7901 20.8051 12.6201 20.8051H13.3251C13.9401 20.8051 14.4651 20.4351 14.7001 19.9051C15.0801 19.9551 15.4601 20.0701 15.8301 20.2451C16.3101 20.4701 16.8051 20.7051 17.4251 20.7051H19.5401C20.7951 20.7051 21.7101 19.6451 21.9901 17.8651C22.1051 17.1151 22.3701 14.6301 20.8551 14.0051ZM21.0001 17.7101C20.9251 18.1801 20.6051 19.7051 19.5401 19.7051H17.4251C17.0301 19.7051 16.6751 19.5401 16.2251 19.3251C15.7801 19.1101 15.3101 18.9751 14.8251 18.9101V15.7801C15.4501 15.5851 16.3701 15.0301 16.9901 13.4551C17.3901 12.4451 17.8401 11.3051 18.1101 11.2001C18.1251 11.1951 18.1701 11.2001 18.2401 11.2351C18.3051 11.2701 18.3551 11.3651 18.3501 11.4551L18.2001 14.2651C18.1901 14.4151 18.2451 14.5551 18.3551 14.6551C18.4601 14.7551 18.6101 14.8051 18.7501 14.7901C19.0601 14.7601 19.9751 14.7201 20.4751 14.9301C21.0651 15.1751 21.1901 16.5151 21.0001 17.7101Z"
                fill="white"
              />
            </svg>
            나만의 장소 추천하기
          </button>
        </form>
      </div>
      <footer>
        <nav class="bottom_nav">
          <div class="nav_item">
            <a href="{% url 'post:together_main' %}">
              <img src="{% static 'image/nav_people.svg' %}" class="nav_icon" />
              <span>함께걸음!</span>
            </a>
          </div>
          <div class="nav_item">
            <a href="{% url 'course:course_list' %}">
              <img src="{% static 'image/nav_find.svg' %}" class="nav_icon" id="nav_icon_margin_right" />
              <span>어디걸음?</span>
            </a>
          </div>
          <div class="nav_item">
            <a href="{% url 'course:calendar_view' %}">
              <img src="{% static 'image/nav_calendar.svg' %}" class="nav_icon" />
              <span>걸음캘린더</span>
            </a>
          </div>
          <div class="nav_item">
            <a href="{% url 'users:mypage_view' %}">
              <img src="{% static 'image/nav_socks.svg' %}" class="nav_icon" id="nav_icon_margin_right" />
              <span>마이걸음</span>
            </a>
          </div>
        </nav>
      </footer>
    </div>

    <script>
              let map;
              let marker;

        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 37.5665, lng: 126.9780 },
                zoom: 13
            });

            const input = document.getElementById("search-location");
            autocomplete = new google.maps.places.Autocomplete(input);
            autocomplete.bindTo("bounds", map);

            autocomplete.addListener("place_changed", () => {
                const place = autocomplete.getPlace();
                if (!place.geometry || !place.geometry.location) {
                    alert("장소를 찾을 수 없습니다.");
                    return;
                }

                // 지도 이동 및 마커 추가
                map.setCenter(place.geometry.location);
                map.setZoom(15);
                placeMarker(place.geometry.location);
            });

                  map.addListener("click", (event) => {
                      placeMarker(event.latLng);
                  });
              }

              function placeMarker(location) {
                  if (marker) {
                      marker.setPosition(location);
                  } else {
                      marker = new google.maps.Marker({
                          position: location,
                          map: map
                      });
                  }
                  document.getElementById("latitude").value = location.lat();
                  document.getElementById("longitude").value = location.lng();

                  // 선택된 좌표로 지도 미리보기 업데이트
                  document.getElementById("map-preview").src =
                      `https://www.google.com/maps/embed/v1/place?key=AIzaSyBee6FEr_x2fj9EqPDmktobzcQ6dPkAouk&q=${location.lat()},${location.lng()}&zoom=15`;

                  // Geocoding API를 사용하여 주소 변환
                  fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${location.lat()},${location.lng()}&key=AIzaSyBee6FEr_x2fj9EqPDmktobzcQ6dPkAouk`)
                      .then(response => response.json())
                      .then(data => {
                          if (data.status === "OK" && data.results.length > 0) {
                              document.getElementById("location-name").value = data.results[0].formatted_address;
                          } else {
                              document.getElementById("location-name").value = "선택된 위치";
                          }
                      })
                      .catch(error => console.error("Error fetching address:", error));
              }

              document.getElementById("select-location").addEventListener("click", function() {
                  document.getElementById("map-popup").style.display = "block";
              });

        function openMapPopup() {
            document.getElementById('map-popup').style.display = 'block';
            document.querySelector('footer').classList.add('hidden-footer');  // 푸터 숨기기

            // 지도가 하얗게 되는 문제 해결을 위해 resize 트리거
            setTimeout(() => {
                google.maps.event.trigger(map, 'resize');
            }, 300);  // 약간의 딜레이 추가
        }

              function closeMapPopup() {
                  document.getElementById("map-popup").style.display = "none";
                  document.querySelector('footer').classList.remove('hidden-footer');  // 푸터 다시 보이게
              }

              document.getElementById("select-location").addEventListener("click", function() {
          document.getElementById("map-popup").style.display = "block";
      });

      // "확인" 버튼 클릭 시, 지도에서 선택된 위치 정보를 form에 넘겨주기
      function closeMapPopup() {
          document.getElementById("map-popup").style.display = "none";

          // latitude와 longitude 값 form에 넣어줌
          if (marker) {
              document.getElementById("latitude").value = marker.getPosition().lat();
              document.getElementById("longitude").value = marker.getPosition().lng();
          }
      }

              document.querySelectorAll('.card').forEach(card => {
                  card.addEventListener('click', function() {
                      const courseId = this.getAttribute('data-id');
                      window.location.href = `/course/course/${courseId}/`;  // 상세 페이지로 이동
                  });
              });

              const searchInput = document.querySelector('.search-box input');
              const searchButton = document.querySelector('.search-box svg');
              const courseCards = document.querySelectorAll('.recommendations .card');

              searchButton.addEventListener('click', function() {
                  const searchText = searchInput.value.trim().toLowerCase(); // 입력된 검색어를 소문자로 변환
                  courseCards.forEach(card => {
                      const title = card.textContent.trim().toLowerCase(); // 각 카드의 텍스트(제목)를 가져와서 소문자로 변환
                      if (title.includes(searchText)) {
                          card.style.display = 'block'; // 검색어가 포함된 경우 보이기
                      } else {
                          card.style.display = 'none'; // 검색어가 포함되지 않은 경우 숨기기
                      }
              });
          });
              const MAX_KEYWORDS = 5;
              const loadMoreButton = document.getElementById('loadMoreKeywords');
              const keywordsContainer = document.querySelector('.keywords');
              const findButton = document.getElementById('findButton');

              const moreKeywords = [
              {% for keyword in keywords|slice:"3:" %}
                  "{{ keyword.name }}"{% if not forloop.last %}, {% endif %}
              {% endfor %}
              ];

              let isExpanded = false;

              // 키워드 버튼 클릭 시 active 클래스를 토글하여 선택/해제 처리
              keywordsContainer.addEventListener('click', function(event) {
                  if (event.target.classList.contains('keyword') && event.target !== loadMoreButton) {
                      const activeKeywords = keywordsContainer.querySelectorAll('.keyword.active');

                      // 선택을 해제하는 경우 그대로 허용
                      if (event.target.classList.contains('active')) {
                          event.target.classList.remove('active');
                      } else {
                          // 선택된 키워드가 5개 이상이면 추가 선택 방지
                          if (activeKeywords.length >= MAX_KEYWORDS) {
                              alert(`최대 ${MAX_KEYWORDS}개의 키워드만 선택할 수 있습니다.`);
                              return;
                          }
                          event.target.classList.add('active');
                      }

                      // 기존 기능: 선택이 해제된 경우, 해당 키워드는 삭제 (단, 기본 키워드는 유지)
                      if (!event.target.classList.contains('active') && !event.target.classList.contains('passive')) {
                          if (!isExpanded) {
                              event.target.remove();  // 추가된 키워드만 삭제
                          }
                      }
                  }
              });

              // "더 보기 ▼" 클릭 시 추가 키워드 삽입
              loadMoreButton.addEventListener('click', function () {
                  if (!isExpanded) {
                      moreKeywords.forEach(keyword => {
                          // 기존 키워드 중에 같은 내용이 있으면 추가하지 않음
                          const existingKeywords = Array.from(keywordsContainer.querySelectorAll('.keyword')).map(btn => btn.textContent);
                          if (!existingKeywords.includes(keyword)) {
                              const newButton = document.createElement('button');
                              newButton.classList.add('keyword');
                              newButton.textContent = keyword;
                              keywordsContainer.insertBefore(newButton, loadMoreButton);
                          }
                      });
                      loadMoreButton.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="38" height="31" viewBox="-4 0 38 31" fill="none"><path transform="rotate(180 19 15.5)" d="M23.7281 20.1412L33.6978 11.8304C34.1109 11.4866 34.1668 10.8716 33.8218 10.4588C33.4762 10.045 32.8636 9.9891 32.4502 10.3335L23.104 18.1247L13.7584 10.3335C13.3441 9.98971 12.7312 10.0456 12.3862 10.4588C12.0411 10.8713 12.097 11.4866 12.5102 11.8304L22.4793 20.1412C22.6604 20.2926 22.8824 20.368 23.104 20.368C23.3259 20.368 23.5475 20.2926 23.7281 20.1412Z" fill="#76453B"/></svg>';

                      isExpanded = true;
                  } else {
                      // 추가된 키워드 중 선택되지 않은 키워드만 제거
                      const addedKeywords = Array.from(keywordsContainer.querySelectorAll('.keyword'))
                          .filter(button => button !== loadMoreButton && !button.classList.contains('active') && !button.classList.contains('passive'));

                      addedKeywords.forEach(keyword => {
                          keyword.remove();
                      });

                      loadMoreButton.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="38" height="31" viewBox="5 0 38 31" fill="none"><path d="M23.7281 20.1412L33.6978 11.8304C34.1109 11.4866 34.1668 10.8716 33.8218 10.4588C33.4762 10.045 32.8636 9.9891 32.4502 10.3335L23.104 18.1247L13.7584 10.3335C13.3441 9.98971 12.7312 10.0456 12.3862 10.4588C12.0411 10.8713 12.097 11.4866 12.5102 11.8304L22.4793 20.1412C22.6604 20.2926 22.8824 20.368 23.104 20.368C23.3259 20.368 23.5475 20.2926 23.7281 20.1412Z" fill="#76453B"/></svg>';
                      isExpanded = false;
                  }
              });

              // "장소 찾기" 버튼 클릭 시 선택된 키워드를 서버로 전송
              findButton.addEventListener('click', function() {
                  // 선택된 키워드를 배열로 수집
                  const selectedKeywords = Array.from(keywordsContainer.querySelectorAll('.keyword.active')).map(button => button.textContent);

                  // 선택된 키워드를 콘솔에 출력 (이 부분을 서버로 전송하는 코드로 바꿀 수 있음)
                  console.log("선택된 키워드들:", selectedKeywords);

                  // 예시: 키워드를 서버로 전송 (fetch API 사용)
                  fetch('/your-server-endpoint', {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/json'
                      },
                      body: JSON.stringify({ keywords: selectedKeywords })
                  })
                  .then(response => response.json())
                  .then(data => {
                      console.log("서버 응답:", data);
                  })
                  .catch(error => {
                      console.error("서버 에러:", error);
                  });
              });

            document.getElementById("findButton").addEventListener("click", function() {
                const selectedKeywords = Array.from(document.querySelectorAll(".keyword.active"))
                    .map(button => encodeURIComponent(button.textContent));

                if (selectedKeywords.length === 0) {
                    alert("최소 하나의 키워드를 선택하세요!");
                    return;
                }

                if (selectedKeywords.length > 5) {
                    alert("최대 5개의 키워드만 선택할 수 있습니다.");
                    return;
                }

                // 선택한 키워드를 URL 파라미터로 추가하여 이동
                const queryString = selectedKeywords.map(keyword => `keywords=${keyword}`).join("&");
                window.location.href = `/course/selectKeyWords/?${queryString}`;
            });
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBee6FEr_x2fj9EqPDmktobzcQ6dPkAouk&libraries=places&callback=initMap" async defer></script>
  </body>
</html>
